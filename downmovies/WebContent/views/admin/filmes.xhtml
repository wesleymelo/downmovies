<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">

<ui:composition template="../modelo/template.xhtml">
	<ui:define name="conteudo">
		<div class="center_content">

			<h:form id="form" prependId="false">

				<p:messages id="messages" />

				<!-- Button -->
				<div class="float-float">

					<p:commandLink action="filme.jsf?faces-redirect=true">
						<p:graphicImage value="../images/plus2.png" alt="Novo Filme"
							style="border:0px;" />
					</p:commandLink>

				</div>
				<br/><br/>
				<p:dataTable id="tabela" value="#{filmeManagedBean.filmes}"
					var="filme" widgetVar="filmesTable" paginator="true"
					rowsPerPageTemplate="5,10,20,30" rows="10"
					emptyMessage="Nenhum filme encontrado"
					filteredValue="#{filmeManagedBean.filteredFilmes}">

					<f:facet name="header">  
			            Lista de Filmes
		        	</f:facet>

					<p:column headerText="#" sortBy="#{filme.idFilme}">
						#{filme.idFilme}
					</p:column>

					<p:column headerText="Título" sortBy="#{filme.titulo}"
						filterBy="#{filme.titulo}">
						#{filme.titulo}
					</p:column>

					<p:column headerText="Diretor" sortBy="#{filme.diretor}"
						filterBy="#{filme.diretor}">
						#{filme.diretor}
					</p:column>


					<p:column headerText="Ano de Lançamento"
						sortBy="#{filme.anoLancamento}" filterBy="#{filme.anoLancamento}">
						#{filme.anoLancamento}
					</p:column>

					<p:column headerText="Idioma" sortBy="#{filme.descricaoIdioma}"
						filterBy="#{filme.descricaoIdioma}">
						#{filme.descricaoIdioma}
					</p:column>

					<p:column headerText="Ações" width="70">




						<p:commandLink update=":form:filmeDetail"
							oncomplete="filmeDialog.show()" title="Visão Detalhada">
							<h:graphicImage value="../images/search.png" title="Detalhar"
								style="border: none" />
							<f:setPropertyActionListener value="#{filme}"
								target="#{filmeManagedBean.filme}" />
						</p:commandLink>
						
						&nbsp;					
						
						<h:commandLink action="filme">
							<f:setPropertyActionListener target="#{filmeManagedBean.filme}"
								value="#{filme}" />
							<h:graphicImage value="../images/edit2.png" title="Editar"
								style="border: none" />
						</h:commandLink>

						&nbsp;						
					
						<p:commandLink onclick="confirmation.show()">
							<p:graphicImage value="../images/delete2.png" title="Excluir"
								style="border: none" />
							<f:setPropertyActionListener value="#{filme}" target="#{filmeManagedBean.filme}" />
						</p:commandLink>
						
						
						<!-- <p:commandButton value="EXCLUIR" title="Excluir" onclick="confirmation.show()" style="margin-left: 5px" >
							<h:graphicImage value="../images/delete2.png" title="Excluir"
								style="border: none" /> -->
                        <!-- Abaixo temos o setPropertyActionListener que é utilizado para pegar o objeto cli e setar no objeto cliente la no nosso bean, para posteriomente excluirmos-->

                        <!--  <f:setPropertyActionListener value="#{filme}" target="#{filmeManagedBean.filme}" />

                    </p:commandButton>-->
						
					</p:column>

				</p:dataTable>

				<p:dialog header="Filme detalhado" widgetVar="filmeDialog"
					modal="true">
					<p:outputPanel id="filmeDetail" style="text-align:center;" layout="block">
							<p:graphicImage
								value="../filmes/#{filmeManagedBean.filme.idFilme}.#{filmeManagedBean.filme.extensaoImg}"
								alt="#{filmeManagedBean.filme.titulo}" width="230" height="240" />


						<h:panelGrid columns="2" cellpadding="5">
							<h:outputLabel for="id" value="Código: " />
							<h:outputText id="id" value="#{filmeManagedBean.filme.idFilme}" />

							<h:outputLabel for="titulo" value="Título: " />
							<h:outputText id="titulo"
								value="#{filmeManagedBean.filme.titulo}" />

							<h:outputLabel for="diretor" value="Diretor: " />
							<h:outputText id="diretor"
								value="#{filmeManagedBean.filme.diretor}" />

							<h:outputLabel for="categoria" value="Categoria: " />
							<h:outputText id="categoria"
								value="#{filmeManagedBean.filme.categoria.descricao}" />

							<h:outputLabel for="anoLancamento" value="Ano Lançamento: " />
							<h:outputText id="anoLancamento"
								value="#{filmeManagedBean.filme.anoLancamento}" />

							<h:outputLabel for="idioma" value="Idioma: " />
							<h:outputText id="idioma"
								value="#{filmeManagedBean.filme.descricaoIdioma}" />

							<h:outputLabel for="legenda" value="Legenda: " />
							<h:outputText id="legenda"
								value="#{filmeManagedBean.filme.descricaoLegenda}" />

							<h:outputLabel for="formato" value="Formato: " />
							<h:outputText id="formato"
								value="#{filmeManagedBean.filme.descricaoFormato}" />

							<h:outputLabel for="qualidade" value="Qualidade: " />
							<h:outputText id="qualidade"
								value="#{filmeManagedBean.filme.descricaoQualidade}" />

							<h:outputLabel for="tempoDuracao" value="Tempo Duração: " />
							<h:outputText id="tempoDuracao"
								value="#{filmeManagedBean.filme.tempoDuracao}" />

							<h:outputLabel for="descricao" value="Descricão: " />
							<h:outputText id="descricao"
								value="#{filmeManagedBean.filme.descricao}" />

						</h:panelGrid>
					</p:outputPanel>
				</p:dialog>





			</h:form>


			<h:form id="dlg">

            <p:confirmDialog  message="Deseja realmente excluir o filme selecionado?" hideEffect="explode" header="Aviso" severity="alert" widgetVar="confirmation" modal="true">

                <!--caso seja sim chamo o metodo excluir, e fecho o modal com o oncomplete, tenho o process que estou dizendo para processar o form, e update para atualizar a tabela-->

                <p:commandButton id="btnSim" value="Sim" oncomplete="confirmation.hide();" action="#{filmeManagedBean.excluir}" process="@form" update=":form:tabela" />

                <!--caso seja não somente fecha o modal-->

                <p:commandButton id="btnNao" value="Não" oncomplete="confirmation.hide();" action="#{filmeManagedBean.init}" process="@form" update=":form:tabela"/>

            </p:confirmDialog>

        </h:form>
			


		</div>
		<!-- end of center content -->
	</ui:define>
</ui:composition>

</html>